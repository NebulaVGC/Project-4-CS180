import java.awt.print.PrinterAbortException;
import java.io.*;
import java.nio.file.ProviderNotFoundException;
import java.util.ArrayList;
import java.util.Scanner;

public class Teacher {
    private String name;
    private String[] courses;
    private String passWord;
    private Scanner scan = new Scanner(System.in);

    public Teacher(String name, String passWord, String[] courses) {
        this.name = name;
        this.courses = courses;
        this.passWord = passWord;
        File f = new File(name + "_Courses");
        try {
            f.createNewFile();
            PrintWriter pw = new PrintWriter(new FileOutputStream(f));
            PrintWriter pw2 = null;
            for (int i = 0; i < courses.length; i++) {
                pw.println(courses[i]);
                File f2 = new File(name + "_" + courses[i] + "_Quizzes");
                f2.createNewFile();
            }
            pw.close();

        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public String getName() {
        return name;
    }

    public String getPassWord() {
        return passWord;
    }

    public void createCourse() {
        System.out.println("Enter the name of the new course");
        String courseName = scan.next();

        try {
            File f1 = new File(name + "_Courses");
            PrintWriter pw = new PrintWriter(new FileOutputStream(f1, true));
            File f2 = new File(name + "_" + courseName + "_Quizzes");
            f2.createNewFile();
            pw.println(courseName);
            pw.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public void deleteCourse() {
        System.out.println("Enter the name of the course you want to delete");
        String courseName = scan.next();
    }

    public void createQuiz() {
        String course;
        String quizName;
        int contains = 0;
        PrintWriter pw = null;
        PrintWriter pw2 = null;


        System.out.println("What is the course this quiz is for?");
        course = scan.nextLine();
        //Check if this course exists
        for (int i = 0; i < courses.length; i++) {
            if (course.equals(courses[i])) {
                contains = 1;
            }
        }
        if (contains == 0) {
            do {
                System.out.println("This course does not exist. Please enter another course");
                course = scan.nextLine();
                for (int i = 0; i < courses.length; i++) {
                    if (course.equals(courses[i])) {
                        contains = 1;
                    }
                }
            } while (contains == 0);
        }
        System.out.println("What is the name of the quiz?");
        quizName = scan.nextLine();
        try {
            File f = new File(name + "_" + quizName);
            pw = new PrintWriter(new FileOutputStream(f));
            File f2 = new File(name + "_" + quizName + "_answers");
            pw2 = new PrintWriter(new FileOutputStream(f2));
            f.createNewFile();
            f2.createNewFile();

        } catch (FileNotFoundException e) {
            //Input Validation
        } catch (IOException e) {
            e.printStackTrace();
        }
        int count = 1;
        int choice = 1;
        int question;

        System.out.println("Do you want to add a question?");
        System.out.println("1.Yes");
        System.out.println("2.No");
        choice = scan.nextInt();
        while (choice == 1) {

            System.out.println("Please type question " + count);
            scan.nextLine();
            String givenQuestion = scan.next();
            System.out.println("Please type answer option A");
            String answerA = scan.next();
            System.out.println("Please type answer option B");
            scan.nextLine();
            String answerB = scan.next();
            System.out.println("Please type answer option C");
            String answerC = scan.next();
            System.out.println("Please type answer option D");
            String answerD = scan.next();
            System.out.println("Please enter the correct answer for question " + count);
            String correctAnswer = scan.next();
            count = count + 1;

            pw.println(givenQuestion);
            pw.println(answerA);
            pw.println(answerB);
            pw.println(answerC);
            pw.println(answerD);
            pw2.println(correctAnswer);
            System.out.println("Do you want to add a question?");
            System.out.println("1.Yes");
            System.out.println("2.No");
            choice = scan.nextInt();


        }

        System.out.println("The quiz is completed");

        pw.close();
        pw2.close();
    }

    public void editQuiz() {
        //ask for the file name of the quiz that is going to be edited. Print that quiz to an arraylist. Ask for the quesiton that is going to be edited
        // Edit the specific lines of the array list that corrospondto the question that is being editied. set these edited lines to the arraylist
        // print the new arraylist to the file and save it
    }

    public void deleteQuiz() {
        Scanner scan = new Scanner(System.in);
        System.out.println("Enter the name of the quiz you want to delete.");
        String quizName = scan.nextLine();
        File file = new File(quizName);

        if (file.delete()) {
            System.out.println("File deleted successfully");
        } else {
            System.out.println("Failed to delete the file");
        }

    }

    public void viewStudentSubmission() {
        String student;
        String course;
        String quizName;
        System.out.println("Enter the name of the student you would like to view");
        student = scan.next();
        System.out.println("Enter the quiz course");
        course = scan.next();
        System.out.println("Enter the name of the quiz");
        quizName = scan.next();
        File f = new File(student + "_" + name + "_" + course + "_" + quizName);
        if (!f.exists()) {
            System.out.println("This quiz does not exist");

        } else {
            try {
                BufferedReader bfr = new BufferedReader(new FileReader(f));
                String line = bfr.readLine();
                System.out.println(line);
                while (line != null) {
                    line = bfr.readLine();
                    System.out.println();
                }
                bfr.close();
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }

    }

    public void randomizeQuiz() {

    }

    /*public void automaticGrade() {
        String student;
        String course;
        String quizName;
        int numCorrect;
        int totalQuestions;
        System.out.println("Enter the name of the student you would like to view");
        student = scan.next();
        System.out.println("Enter the quiz course");
        course = scan.next();
        System.out.println("Enter the name of the quiz");
        quizName = scan.next();
        File studentQuiz = new File(student + "_" + name + "_" + course + "_" + quizName);
        if (!studentQuiz.exists()) {
            System.out.println("This quiz does not exist");

        } else {
            File teacherQuiz = new File(name + "_" + quizName);
            try {
                BufferedReader bfr1 = new BufferedReader(new FileReader(studentQuiz));
                BufferedReader bfr2 = new BufferedReader(new FileReader(teacherQuiz));
                String line1 = bfr1.readLine();
                String line2 = bfr2.readLine();
                while (line2 != null) {
                    bfr1.
                }
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }*/

        public void manualGrade () {
            String student;
            String course;
            String quizName;
            int numCorrect = 0;
            int totalQuestions;
            System.out.println("Enter the name of the student you would like to grade");
            student = scan.next();
            System.out.println("Enter the quiz course");
            course = scan.next();
            System.out.println("Enter the name of the quiz");
            quizName = scan.next();
            File studentQuiz = new File(student + "_" + name + "_" + course + "_" + quizName);
            if (!studentQuiz.exists()) {
                System.out.println("This quiz does not exist");

            } else {
                File teacherQuiz = new File(name + "_" + quizName);
                try {
                    BufferedReader bfr1 = new BufferedReader(new FileReader(studentQuiz));
                    BufferedReader bfr2 = new BufferedReader(new FileReader(teacherQuiz));
                    ArrayList<String> studentAnswers = new ArrayList<>();
                    ArrayList<String> correct = new ArrayList<>();
                    String line1 = bfr1.readLine();
                    String line2 = bfr2.readLine();
                    while(line1 != null) {
                        System.out.println(line2);
                        line2 = bfr2.readLine();
                        System.out.println(line2);
                        line2 = bfr2.readLine();
                        System.out.println(line2);
                        line2 = bfr2.readLine();
                        System.out.println(line2);
                        line2 = bfr2.readLine();
                        System.out.println(line2);
                        line2 = bfr2.readLine();
                        System.out.println("Student Answer: " + line1);
                        studentAnswers.add(line1);
                        String yesNo = null;
                        do {
                            System.out.println("Is this correct? Y/N");
                            yesNo = scan.next();
                            if(!yesNo.equals("Y") && !yesNo.equals("N")) {
                                System.out.println("Try again");
                            }
                            else if(yesNo.equals("Y")) {
                                numCorrect++;
                            }
                        } while(!yesNo.equals("Y") && !yesNo.equals("N"));
                        correct.add(yesNo);
                        line1 = bfr1.readLine();
                    }

                    double percentage = (double) numCorrect / correct.size() * 100;
                    System.out.println("Grade: " + percentage);
                    PrintWriter pw = new PrintWriter(new FileOutputStream(studentQuiz));
                    for (int i = 0; i < studentAnswers.size(); i++) {

                        if(correct.get(i).equals("Y")) {

                            pw.println(studentAnswers.get(i) + " Correct");
                        } else {
                            pw.println(studentAnswers.get(i) + " Wrong");
                        }
                    }

                    pw.close();
                    bfr1.close();
                    bfr2.close();
                } catch (FileNotFoundException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
        public static void main (String[]args){
            String[] s = {"Physics", "Math", "English"};
            Teacher teacher = new Teacher("Teacher", "1234", s);
            teacher.teacherInterface();





        }

        public void teacherInterface() {
            int choice = 0;
            System.out.println("What would you like to do?\n1. Create Quiz\n2. Edit Quiz\n3. Delete Quiz");
            System.out.println("4. Grade Quiz\n5. View Student Submission\n6. Create Course\n7. Delete Course");
            System.out.println("8. Exit");
            do {
                choice = scan.nextInt();
                if(choice < 1 || choice > 8) {
                    System.out.println("Not an option");
                }
            } while(choice < 1 || choice > 8);

            if(choice == 1) {
                createQuiz();
            }
            else if(choice == 2) {
                editQuiz();
            }
            else if(choice == 3) {
                deleteQuiz();
            }
            else if(choice == 4) {
                manualGrade();
            }
            else if(choice == 5) {
                viewStudentSubmission();
            }
            else if(choice == 6) {
                createCourse();
            }
            else if(choice == 7) {
                deleteCourse();
            } else {
                return;
            }
        }
    }

